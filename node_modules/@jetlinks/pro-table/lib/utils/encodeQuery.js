"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = encodeQuery;

function encodeQuery(params) {
  if (!params) return {};
  var queryParam = {
    pageIndex: 0,
    current: params.current
  };
  var terms = params.terms,
      sorts = params.sorts,
      current = params.current;
  Object.keys(params).forEach(function (key) {
    if (key === 'terms') {
      var index = 0;
      if (!terms) return;
      Object.keys(terms).forEach(function (k) {
        if (!(terms[k] === '' || terms[k] === undefined || terms[k].length === 0 || terms[k] === {} || terms[k] === null)) {
          if (k.indexOf('$LIKE') > -1 && terms[k].toString().indexOf('%') === -1) {
            terms[k] = "%".concat(terms[k], "%");
          }

          if (k.indexOf('$IN') > -1) {
            terms[k] = terms[k].toString();
          } else if (k.indexOf('$START') > -1) {
            terms[k] = "%".concat(terms[k]);
          } else if (k.indexOf('$END') > -1) {
            terms[k] = "".concat(terms[k], "%");
          }

          if (k.indexOf('@') > -1) {
            var temp = k.split('@'); // eslint-disable-next-line prefer-destructuring

            queryParam["terms[".concat(index, "].column")] = temp[0]; // eslint-disable-next-line prefer-destructuring

            queryParam["terms[".concat(index, "].type")] = temp[1];
          } else {
            queryParam["terms[".concat(index, "].column")] = k;
          }

          queryParam["terms[".concat(index, "].value")] = terms[k];
          index += 1;
        }
      });
    } else if (key === 'sorts') {
      // 当前Ant Design排序只支持单字段排序
      if (!sorts) return;
      Object.keys(sorts).forEach(function (s, index) {
        queryParam["sorts[".concat(index, "].name")] = s;
        queryParam["sorts[".concat(index, "].order")] = sorts[s].replace("end", "");
      }); // if (Object.keys(sorts).length > 0) {
      //     queryParam[`sorts[0].name`] = sorts.field;
      //     queryParam[`sorts[0].order`] = (sorts.order || '').replace('end', '');
      // }
    } else {
      queryParam[key] = params[key];
    }
  });
  queryParam.pageIndex = current - 1; // delete queryParam.current;

  return queryParam;
}